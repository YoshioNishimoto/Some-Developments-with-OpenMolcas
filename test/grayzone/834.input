*-------------------------------------------------------------------------------
* Molecule: Water dimer
* Basis: cc-pVDZ
* Symmetry: C1
* Features tested: Molcas/Gromacs interface
* Responsible person: Michael Stenrup
* Comments: Only run test if interface is installed
*-------------------------------------------------------------------------------
* Test if Gromacs is available and skip the test if not
> RM -FORCE TEST_GROMACS
> IF ( $MOLCAS_DRIVER = UNKNOWN_VARIABLE )
>   EXPORT MOLCAS_DRIVER=molcas
> ENDIF
> SHELL $MOLCAS_DRIVER have_feature gromacs || touch TEST_GROMACS
> IF ( -FILE TEST_GROMACS )
>   EXIT 36
> ENDIF
*-------------------------------------------------------------------------------
> FILE conf.gro
Water dimer
   6
    1SOLQM   OW    1   -.155   -.011    .000
    1SOLQM  HW1    2   -.193    .076    .000
    1SOLQM  HW2    3   -.039   -.012   -.000
    2SOL     OW    4    .224    .016    .116
    2SOL    HW1    5    .264   -.036    .046
    2SOL    HW2    6    .253   -.035    .177
   1.0 1.0 1.0
> EOF
*-------------------------------------------------------------------------------
> FILE index.ndx
[ System ]
 1 2 3 4 5 6
[ QM ]
 1 2 3
[ MM ]
 4 5 6
> EOF
*-------------------------------------------------------------------------------
> FILE topol.top
#include "oplsaa.ff/forcefield.itp"
#include "oplsaa.ff/spc.itp"
#include "spcqm.itp"

[ system ]
 Water dimer

[ molecules ]
 SOLQM 1
 SOL 1
> EOF
*-------------------------------------------------------------------------------
> FILE spcqm.itp
[ moleculetype ]
 SOLQM 2

[ atoms ]
 1 opls_116 1 SOLQM  OW 1 -0.82
 2 opls_117 1 SOLQM HW1 1  0.41
 3 opls_117 1 SOLQM HW2 1  0.41

[ bonds ]
 1 2 5
 1 3 5
> EOF
*-------------------------------------------------------------------------------
> FILE grompp.mdp
define = -DFLEXIBLE

cutoff-scheme = group
pbc = no
rlist = 0

coulombtype = cut-off
rcoulomb = 0

vdwtype = cut-off
rvdw = 0

QMMM = yes
QMMM-grps = QM
QMMMscheme = slave
QMmethod = CASSCF
QMbasis = STO-3G
> EOF
*-------------------------------------------------------------------------------
> SHELL grompp_d -n index
> EXPORT GMX_NB_GENERIC=1
> EXPORT GMX_MAXBACKUP=-1

&GATEWAY
Gromacs
 Simple
Basis
 cc-pVDZ
Group
 NoSym
NoCD

> DO WHILE

&SEWARD

&ESPF
External
 Gromacs
MMIterations
 1000

&SCF

&SLAPAF
Cartesian

> ENDDO
>>FILE checkfile
* This file is autogenerated:
* Molcas version 21.02-1119-gde6a49c4e
* Linux otis 4.15.0-1073-oem #83-Ubuntu SMP Mon Feb 17 11:21:18 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux
* Sun May 16 11:14:45 2021
*
#>>   1
#> POTNUC="8.406904165079"/12
#>>   2
#> POTNUC="8.406904165079"/6
#> SEWARD_MLTPL1X="-2.929075493170"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.151990197910"/5
#>>   3
#> POTNUC="8.330488832533"/6
#>>   4
#> SCF_ITER="10"/8
#> E_SCF="-75.970962302008"/8
#> ESPF_MULTIPOLES[0]="-0.752819898873"/6
#> ESPF_MULTIPOLES[1]="0.386250800750"/6
#> ESPF_MULTIPOLES[2]="0.366389834775"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.514593112495"/5
#> MLTPL__1[1]="0.613220870281"/5
#> MLTPL__1[2]="0.0"/5
#> MLTPL__2[0]="1.888517382152"/5
#> MLTPL__2[1]="-1.190723800984"/5
#> MLTPL__2[2]="0.0"/5
#> MLTPL__2[3]="0.040538644413"/5
#> MLTPL__2[4]="0.0"/5
#> MLTPL__2[5]="-1.929056026566"/5
#>>   5
#> GRAD[0]="-0.115071426743"/6
#> GRAD[1]="0.019677647117"/6
#> GRAD[2]="0.0"/6
#> GRAD[3]="-0.021208728872"/6
#> GRAD[4]="-0.002033169707"/6
#> GRAD[5]="0.0"/6
#> GRAD[6]="0.136280155615"/6
#> GRAD[7]="-0.017644477410"/6
#> GRAD[8]="0.0"/6
#> GRAD[0]="-0.111079997207"/6
#> GRAD[1]="0.022570752683"/6
#> GRAD[2]="0.000909608631"/6
#> GRAD[3]="-0.020148862836"/6
#> GRAD[4]="-0.004585171793"/6
#> GRAD[5]="-0.000382971531"/6
#> GRAD[6]="0.130114131918"/6
#> GRAD[7]="-0.018539419785"/6
#> GRAD[8]="-0.001527677072"/6
#>>   6
#>>   7
#>>   9
#> POTNUC="8.956225229938"/6
#> SEWARD_MLTPL1X="-2.899537245366"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.216082305578"/5
#>>  10
#> POTNUC="8.639481144356"/6
#>>  11
#> SCF_ITER="9"/8
#> E_SCF="-76.033071046673"/8
#> ESPF_MULTIPOLES[0]="-0.803427412056"/6
#> ESPF_MULTIPOLES[1]="0.369207951993"/6
#> ESPF_MULTIPOLES[2]="0.434450576177"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.593666699209"/5
#> MLTPL__1[1]="0.665253141256"/5
#> MLTPL__1[2]="0.000733051068"/5
#> MLTPL__2[0]="1.486567209594"/5
#> MLTPL__2[1]="-0.850251316531"/5
#> MLTPL__2[2]="0.007587528449"/5
#> MLTPL__2[3]="0.248494092025"/5
#> MLTPL__2[4]="-0.000974807357"/5
#> MLTPL__2[5]="-1.735061301619"/5
#>>  12
#> GRAD[0]="-0.074203425085"/6
#> GRAD[1]="-0.010388381793"/6
#> GRAD[2]="-0.000579464318"/6
#> GRAD[3]="-0.012203967692"/6
#> GRAD[4]="0.009936799139"/6
#> GRAD[5]="0.000005653727"/6
#> GRAD[6]="0.086407392777"/6
#> GRAD[7]="0.000451582653"/6
#> GRAD[8]="0.000573810592"/6
#> GRAD[0]="-0.045295231398"/6
#> GRAD[1]="-0.002191976033"/6
#> GRAD[2]="0.000950780740"/6
#> GRAD[3]="-0.008542195364"/6
#> GRAD[4]="0.004623901828"/6
#> GRAD[5]="0.000049633759"/6
#> GRAD[6]="0.052643527114"/6
#> GRAD[7]="-0.002369838286"/6
#> GRAD[8]="-0.001585720679"/6
#>>  13
#>>  14
#>>  16
#> POTNUC="9.436059760421"/6
#> SEWARD_MLTPL1X="-2.876432003757"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.273037607902"/5
#>>  17
#> POTNUC="9.144905834459"/6
#>>  18
#> SCF_ITER="8"/8
#> E_SCF="-76.034971646651"/8
#> ESPF_MULTIPOLES[0]="-0.800652535931"/6
#> ESPF_MULTIPOLES[1]="0.369050260230"/6
#> ESPF_MULTIPOLES[2]="0.431900981903"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.532951198099"/5
#> MLTPL__1[1]="0.675115620328"/5
#> MLTPL__1[2]="0.007762757622"/5
#> MLTPL__2[0]="1.131093484982"/5
#> MLTPL__2[1]="-0.762078200772"/5
#> MLTPL__2[2]="0.034036962527"/5
#> MLTPL__2[3]="0.436597940533"/5
#> MLTPL__2[4]="-0.007377445976"/5
#> MLTPL__2[5]="-1.567691425515"/5
#>>  19
#> GRAD[0]="0.021593385001"/6
#> GRAD[1]="-0.008439493013"/6
#> GRAD[2]="0.000288349626"/6
#> GRAD[3]="-0.003239234862"/6
#> GRAD[4]="0.007308453055"/6
#> GRAD[5]="-0.000032018135"/6
#> GRAD[6]="-0.018354150139"/6
#> GRAD[7]="0.001131039958"/6
#> GRAD[8]="-0.000256331492"/6
#> GRAD[0]="0.044854580897"/6
#> GRAD[1]="0.000948977364"/6
#> GRAD[2]="0.001354346616"/6
#> GRAD[3]="-0.000250088028"/6
#> GRAD[4]="0.001488125780"/6
#> GRAD[5]="0.000088684997"/6
#> GRAD[6]="-0.045135329124"/6
#> GRAD[7]="-0.002545432334"/6
#> GRAD[8]="-0.001764898692"/6
#>>  20
#>>  21
#>>  23
#> POTNUC="9.223965327605"/6
#> SEWARD_MLTPL1X="-2.886455069069"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.247613506386"/5
#>>  24
#> POTNUC="8.921933298864"/6
#>>  25
#> SCF_ITER="8"/8
#> E_SCF="-76.036451532891"/8
#> ESPF_MULTIPOLES[0]="-0.797531683548"/6
#> ESPF_MULTIPOLES[1]="0.367929203073"/6
#> ESPF_MULTIPOLES[2]="0.429861948277"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.563014161613"/5
#> MLTPL__1[1]="0.673160064110"/5
#> MLTPL__1[2]="0.008778254710"/5
#> MLTPL__2[0]="1.266341366963"/5
#> MLTPL__2[1]="-0.767332025921"/5
#> MLTPL__2[2]="0.040173422341"/5
#> MLTPL__2[3]="0.365242522457"/5
#> MLTPL__2[4]="-0.008610636062"/5
#> MLTPL__2[5]="-1.631583889420"/5
#>>  26
#> GRAD[0]="-0.032589722041"/6
#> GRAD[1]="-0.008608539311"/6
#> GRAD[2]="-0.000431037682"/6
#> GRAD[3]="-0.004388648885"/6
#> GRAD[4]="0.005236369067"/6
#> GRAD[5]="-0.000058512727"/6
#> GRAD[6]="0.036978370927"/6
#> GRAD[7]="0.003372170244"/6
#> GRAD[8]="0.000489550410"/6
#> GRAD[0]="-0.007254137392"/6
#> GRAD[1]="0.000621194900"/6
#> GRAD[2]="0.000751640844"/6
#> GRAD[3]="-0.001284305994"/6
#> GRAD[4]="-0.000426084670"/6
#> GRAD[5]="0.000070462538"/6
#> GRAD[6]="0.007484491409"/6
#> GRAD[7]="-0.000214406441"/6
#> GRAD[8]="-0.001336482785"/6
#>>  27
#>>  28
#>>  30
#> POTNUC="9.254103681779"/6
#> SEWARD_MLTPL1X="-2.883445758410"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.251131176145"/5
#>>  31
#> POTNUC="8.952035440128"/6
#>>  32
#> SCF_ITER="7"/8
#> E_SCF="-76.036521230223"/8
#> ESPF_MULTIPOLES[0]="-0.796956114256"/6
#> ESPF_MULTIPOLES[1]="0.367389356026"/6
#> ESPF_MULTIPOLES[2]="0.429824780736"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.561974238611"/5
#> MLTPL__1[1]="0.673818175098"/5
#> MLTPL__1[2]="0.011613167152"/5
#> MLTPL__2[0]="1.238233670542"/5
#> MLTPL__2[1]="-0.755778445621"/5
#> MLTPL__2[2]="0.054141837646"/5
#> MLTPL__2[3]="0.382020904433"/5
#> MLTPL__2[4]="-0.012310094280"/5
#> MLTPL__2[5]="-1.620254574975"/5
#>>  33
#> GRAD[0]="-0.026526111860"/6
#> GRAD[1]="-0.009169783233"/6
#> GRAD[2]="-0.000465908814"/6
#> GRAD[3]="-0.003547903678"/6
#> GRAD[4]="0.005379658540"/6
#> GRAD[5]="-0.000065184316"/6
#> GRAD[6]="0.030074015539"/6
#> GRAD[7]="0.003790124692"/6
#> GRAD[8]="0.000531093130"/6
#> GRAD[0]="-0.001186095295"/6
#> GRAD[1]="0.000203774150"/6
#> GRAD[2]="0.000758045817"/6
#> GRAD[3]="-0.000497433236"/6
#> GRAD[4]="-0.000326912530"/6
#> GRAD[5]="0.000092171812"/6
#> GRAD[6]="0.000762865110"/6
#> GRAD[7]="0.000132793358"/6
#> GRAD[8]="-0.001291839162"/6
#>>  34
#> GEO_ITER="5"/8
#> POTNUC="9.262233760261"/6
#> SEWARD_MLTPL1X="-2.880670146512"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.252056822287"/5
#> POTNUC="8.959888890349"/6
#> SCF_ITER="7"/8
#> E_SCF="-76.036565987284"/8
#> ESPF_MULTIPOLES[0]="-0.797548249992"/6
#> ESPF_MULTIPOLES[1]="0.367601377116"/6
#> ESPF_MULTIPOLES[2]="0.430246244600"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.563014642301"/5
#> MLTPL__1[1]="0.673563242831"/5
#> MLTPL__1[2]="0.015490603990"/5
#> MLTPL__2[0]="1.225156182050"/5
#> MLTPL__2[1]="-0.749762404943"/5
#> MLTPL__2[2]="0.074345561186"/5
#> MLTPL__2[3]="0.391282240362"/5
#> MLTPL__2[4]="-0.017944971625"/5
#> MLTPL__2[5]="-1.616438422412"/5
#>>  35
#>>  36
>>EOF

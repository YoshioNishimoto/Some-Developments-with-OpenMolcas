* This is a "clone" of test 047
* Note the checkfiles are identical, except:
*   - Some combinations make no sense with HDF5
*   - Changing the order of states in CASPT2 has an effect here,
*     but not without HDF5
*
>> RM -FORCE TEST_HDF5
>> IF ( $MOLCAS_DRIVER = UNKNOWN_VARIABLE )
>>   EXPORT MOLCAS_DRIVER=molcas
>> ENDIF
>> SHELL $MOLCAS_DRIVER have_feature hdf5 || touch TEST_HDF5
>> IF ( -FILE TEST_HDF5 )
>>   EXIT 36
>> ENDIF

>> EXPORT MOLCAS_PRINT=VERBOSE

&SEWARD
  Symmetry = xyz
  mGauss
  Multipoles = 0
  Basis = Ge.ANO-RCC...5s4p2d.
    Ge  0.0  0.0  0.0
  End of Basis
  XField = 2
    4.0 5.0 6.0    2.0 0.0 0.0 0.0
   -4.0 5.0 6.0    2.0 0.0 0.0 0.0
  NoCD

&SCF
  FileOrb    = $Project.guessorb.h5
  Charge     = 2
  Thresholds = 1e-10 1e-6 5e-8 2e-6

&RASSCF
  FileOrb    = $Project.scf.h5
  Symmetry   = 1
  Spin       = 1
  nActEl     = 4 0 0
  Inactive   = 8 6
  Ras2       = 1 3
  LevShft    = 0.5
  Iterations = 200 50
  CIMx       = 48
  CIRoot     = 6 6
               1 6 2 5 3 4
               1 1 1 1 1 1
  Thrs       = 1e-10 1e-06 1e-06
  Tight      = 1e-08 1e-6

&CASPT2
  FileOrb     = $Project.rasscf.h5
  MaxIter     = 25
  IPEA        = 0.25
  Multistate  = 6  1 2 3 4 5 6
  Convergence = 1e-9
  Properties

* Use RASSCF energies
>> COPY $Project.rasscf.h5 CASSCF

&RASSI
  NrOfJobIphs = 1 all
  IphNames = CASSCF

* Use SS-CASPT2 energies (EJOB)
>> COPY $Project.caspt2.h5 CASPT2

&RASSI
  NrOfJobIphs = 1 all
  IphNames = CASPT2
  EJob

* Use MS-CASPT2
>> COPY $Project.caspt2.h5 CASPT2

&RASSI
  NrOfJobIphs = 1 all
  IphNames = CASPT2

* XMS calculation
&CASPT2
  FileOrb     = $Project.rasscf.h5
  MaxIter     = 25
  IPEA        = 0.0
  XMultistate = all
  Convergence = 1e-9

* Use XMS-CASPT2
>> COPY $Project.caspt2.h5 CASPT2

&RASSI
  NrOfJobIphs = 1 all
  IphNames = CASPT2

* Subset of states
&CASPT2
  FileOrb     = $Project.rasscf.h5
  MaxIter     = 25
  IPEA        = 0.25
  Multistate  = 3  6 4 1
  Convergence = 1e-9

* Use MS-CASPT2
>> COPY $Project.caspt2.h5 CASPT2
>> COPY $Project.caspt2.h5 save.caspt2.h5

&RASSI
  NrOfJobIphs = 1 3 ; 1 4 6
  IphNames = CASPT2

* Subset XMS + NoMult
&CASPT2
  FileOrb     = $Project.rasscf.h5
  MaxIter     = 25
  IPEA        = 0.0
  XMultistate = 3  1 4 6
  NoMultistate
  Convergence = 1e-9

* Use XSS-CASPT2 (EJOB)
>> COPY $Project.caspt2.h5 CASPT2

&RASSI
  NrOfJobIphs = 1 all
  IphNames = CASPT2
  EJob

* Mixing Mul an NoMul
&CASPT2
  FileOrb     = $Project.rasscf.h5
  MaxIter     = 25
  IPEA        = 0.0
  Multistate  = 1  6
  Convergence = 1e-9

>> COPY save.caspt2.h5 CASPT2_1
>> COPY $Project.caspt2.h5 CASPT2

&RASSI &END
  NrOfJobIphs = 2 2 1 ; 1 4 ; 6
  IphNames = CASPT2_1 ; CASPT2
  Heff

>>FILE checkfile
* This file is autogenerated:
* Molcas version 23.10-568-gcfcaeaa70
* Linux otis 5.15.0-88-generic #98-Ubuntu SMP Mon Oct 2 15:18:56 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux
* Thu Dec  7 13:25:20 2023
*
#>>   1
#> SEWARD_KINETIC="17955988.950000014156"/5
#> SEWARD_ATTRACT="-168788.747221128375"/5
#> POTNUC="29.173907573667"/12
#> SEWARD_KINETIC="552.394993687087"/5
#> SEWARD_ATTRACT="-1058.908565952243"/5
#>>   2
#> SCF_ITER="14"/8
#> E_SCF="-2094.329154029757"/8
#> MLTPL__0="2"/5
#>>   3
#> RASSCF_ITER="9"/8
#> E_RASSCF[0]="-2097.003291605170"/8
#> E_RASSCF[1]="-2096.888112736222"/8
#> E_RASSCF[2]="-2096.972884650090"/8
#> E_RASSCF[3]="-2096.920335075013"/8
#> E_RASSCF[4]="-2096.959738898080"/8
#> E_RASSCF[5]="-2096.925800888544"/8
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__0="-0.000000000000"/5
#>>   4
#> E_CASPT2="-2097.022010445453"/8
#> MLTPL__0="-0.000000000000"/5
#> E_CASPT2="-2096.992805987090"/8
#> MLTPL__0="-0.000000000000"/5
#> E_CASPT2="-2096.979871621800"/8
#> MLTPL__0="-0.000000000000"/5
#> E_CASPT2="-2096.946032574066"/8
#> MLTPL__0="-0.000000000000"/5
#> E_CASPT2="-2096.940965883032"/8
#> MLTPL__0="-0.000000000000"/5
#> E_CASPT2="-2096.906953225630"/8
#> MLTPL__0="-0.000000000000"/5
#> E_MSPT2[0]="-2097.022027937614"/8
#> E_MSPT2[1]="-2096.992805987090"/8
#> E_MSPT2[2]="-2096.979871621800"/8
#> E_MSPT2[3]="-2096.946058336975"/8
#> E_MSPT2[4]="-2096.940965883032"/8
#> E_MSPT2[5]="-2096.906909970559"/8
#>>   5
#> E_RASSI[0]="-2097.003291605169"/6
#> E_RASSI[1]="-2096.888112736224"/6
#> E_RASSI[2]="-2096.972884650091"/6
#> E_RASSI[3]="-2096.920335075013"/6
#> E_RASSI[4]="-2096.959738898081"/6
#> E_RASSI[5]="-2096.925800888545"/6
#>>   6
#> E_RASSI[0]="-2097.022010445453"/6
#> E_RASSI[1]="-2096.992805987090"/6
#> E_RASSI[2]="-2096.979871621800"/6
#> E_RASSI[3]="-2096.946032574066"/6
#> E_RASSI[4]="-2096.940965883032"/6
#> E_RASSI[5]="-2096.906953225630"/6
#>>   7
#> E_RASSI[0]="-2097.022027937614"/6
#> E_RASSI[1]="-2096.992805987090"/6
#> E_RASSI[2]="-2096.979871621800"/6
#> E_RASSI[3]="-2096.946058336975"/6
#> E_RASSI[4]="-2096.940965883032"/6
#> E_RASSI[5]="-2096.906909970559"/6
#>>   8
#> E_CASPT2="-2097.023932417219"/8
#> E_CASPT2="-2096.909048338869"/8
#> E_CASPT2="-2096.994600419095"/8
#> E_CASPT2="-2096.942852360446"/8
#> E_CASPT2="-2096.981694231074"/8
#> E_CASPT2="-2096.947775130382"/8
#> E_MSPT2[0]="-2097.023958972578"/8
#> E_MSPT2[1]="-2096.994600419095"/8
#> E_MSPT2[2]="-2096.981694231074"/8
#> E_MSPT2[3]="-2096.947865140865"/8
#> E_MSPT2[4]="-2096.942852360446"/8
#> E_MSPT2[5]="-2096.908931773026"/8
#>>   9
#> E_RASSI[0]="-2097.023958972579"/6
#> E_RASSI[1]="-2096.908931773026"/6
#> E_RASSI[2]="-2096.994600419097"/6
#> E_RASSI[3]="-2096.942852360449"/6
#> E_RASSI[4]="-2096.981694231075"/6
#> E_RASSI[5]="-2096.947865140866"/6
#>>  10
#> E_CASPT2="-2096.906953225630"/8
#> E_CASPT2="-2096.946032574066"/8
#> E_CASPT2="-2097.022010445453"/8
#> E_MSPT2[0]="-2097.022027937614"/8
#> E_MSPT2[1]="-2096.946058336975"/8
#> E_MSPT2[2]="-2096.906909970559"/8
#>>  11
#> E_RASSI[0]="-2097.022027937615"/6
#> E_RASSI[1]="-2096.946058336975"/6
#> E_RASSI[2]="-2096.906909970558"/6
#>>  12
#> E_CASPT2="-2097.023949037540"/8
#> E_CASPT2="-2096.947793546568"/8
#> E_CASPT2="-2096.909067364593"/8
#>>  13
#> E_RASSI[0]="-2097.023949037540"/6
#> E_RASSI[1]="-2096.947793546568"/6
#> E_RASSI[2]="-2096.909067364593"/6
#>>  14
#> E_CASPT2="-2096.907739338812"/8
#>>  15
#> E_RASSI[0]="-2097.022015252176"/6
#> E_RASSI[1]="-2096.946027767342"/6
#> E_RASSI[2]="-2096.907739338812"/6
>>EOF
